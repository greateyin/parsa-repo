{{- $colors := .Site.Params.colors | default dict -}}
{{- $theme := .Site.Params.theme | default dict -}}
{{- $primaryColor := $colors.primary | default ($theme.primaryColor | default "#3b82f6") -}}
{{- $pwa := .Site.Params.pwa | default dict -}}
{{- $manifest := dict "name" .Site.Title "short_name" ($pwa.shortName | default .Site.Title) -}}
{{- $manifest = $manifest | merge (dict "description" ($pwa.description | default .Site.Params.description)) -}}
{{- $manifest = $manifest | merge (dict "start_url" "/") -}}
{{- $manifest = $manifest | merge (dict "scope" "/") -}}
{{- $manifest = $manifest | merge (dict "display" "standalone") -}}
{{- $manifest = $manifest | merge (dict "orientation" "portrait-primary") -}}
{{- $manifest = $manifest | merge (dict "theme_color" ($pwa.themeColor | default $primaryColor)) -}}
{{- $manifest = $manifest | merge (dict "background_color" ($pwa.backgroundColor | default "#ffffff")) -}}

{{- $icons := slice -}}
{{- $icons = $icons | append (dict "src" "/images/icon-192x192.png" "sizes" "192x192" "type" "image/png") -}}
{{- $icons = $icons | append (dict "src" "/images/icon-512x512.png" "sizes" "512x512" "type" "image/png") -}}
{{- $icons = $icons | append (dict "src" "/images/icon-maskable-192x192.png" "sizes" "192x192" "type" "image/png" "purpose" "maskable") -}}
{{- $icons = $icons | append (dict "src" "/images/icon-maskable-512x512.png" "sizes" "512x512" "type" "image/png" "purpose" "maskable") -}}
{{- $manifest = $manifest | merge (dict "icons" $icons) -}}

{{- $categories := slice "productivity" "utilities" "lifestyle" -}}
{{- $manifest = $manifest | merge (dict "categories" $categories) -}}

{{- $manifest = $manifest | merge (dict "lang" .Site.Language.Lang) -}}
{{- $manifest = $manifest | merge (dict "dir" (.Site.Params.languageDirection | default "ltr")) -}}

{{ $manifest | jsonify }}