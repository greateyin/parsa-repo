{{ define "main" }}
<div class="container mx-auto px-4 py-8">
  <!-- Search Header -->
  <div class="max-w-4xl mx-auto">
    <div class="text-center mb-8">
      <h1 class="text-4xl font-bold mb-4 bg-gradient-to-r from-primary to-accent bg-clip-text text-transparent">
        {{ i18n "searchTitle" | default "Search Articles" }}
      </h1>
      <p class="text-lg text-muted-foreground">
        {{ i18n "searchDescription" | default "Find the content you're looking for" }}
      </p>
    </div>

    <!-- Search Widget -->
    <div class="relative max-w-2xl mx-auto mb-8">
      {{ partial "widgets/search.html" . }}
    </div>

    <!-- Loading state -->
    <div id="search-loading" class="text-center py-8 hidden">
      <div class="inline-flex items-center">
        <svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-primary" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
          <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
          <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
        </svg>
        {{ i18n "searching" | default "Searching..." }}
      </div>
    </div>

    <!-- Initial state - show recent articles -->
    <div id="initial-content" class="mt-12">
      <h2 class="text-2xl font-bold mb-6">{{ i18n "recentArticles" | default "Recent Articles" }}</h2>
      <div class="grid gap-6 md:grid-cols-2 lg:grid-cols-3">
        {{ range first 6 (where .Site.RegularPages "Type" "in" .Site.Params.mainSections) }}
          {{ partial "content/article-card.html" . }}
        {{ end }}
      </div>
    </div>
  </div>
</div>

<!-- Search JavaScript -->
<script>
// Search functionality will be loaded from main.js
document.addEventListener('DOMContentLoaded', function() {
  // Initialize search if the function exists
  if (typeof initializeSearch === 'function') {
    initializeSearch();
  }
  
  // Handle URL search parameters
  const urlParams = new URLSearchParams(window.location.search);
  const query = urlParams.get('q');
  if (query) {
    const searchInput = document.getElementById('search-input');
    if (searchInput) {
      searchInput.value = query;
      // Trigger search
      if (typeof performSearch === 'function') {
        performSearch(query);
      }
    }
  }
});
</script>
{{ end }}